{"version":3,"sources":["ad-refresher.js"],"names":["init","element","options","LOADING_AD_POSITION_THRESHOLD","RELOADING_AD_POSITION_THRESHOLD","lastY","lastRatio","Error","Element","loadingThreshold","reloadingThreshold","loader","IntersectionObserver","entries","forEach","entry","intersectionRatio","target","dispatchEvent","Event","rootMargin","reloader","currentY","boundingClientRect","y","currentRatio","isIntersecting","observe","AdRefresher","refresh","module","exports","window"],"mappings":"CAAA,WACI,QAASA,GAAKC,EAASC,GACnB,GAAIC,GAAgC,IAChCC,EAAkC,IAClCC,EAAQ,EACRC,EAAY,CAEhB,KAAKL,EACD,KAAM,IAAIM,OAAM,yBAGhBN,GAAQ,YAAcO,WACtBP,EAAUA,EAAQ,IAGtBC,EAAUA,MACVA,EAAQO,iBAAmBP,EAAQO,kBAAoBN,EACvDD,EAAQQ,mBAAqBR,EAAQQ,oBAAsBN,CAE3D,IAAIO,GAAS,GAAIC,sBAAqB,SAASC,GAC3CA,EAAQC,QAAQ,SAASC,GACjBA,EAAMC,kBAAoB,GAC1BD,EAAME,OAAOC,cAAc,GAAIC,OAAM,gBAI7CC,WAAY,WAAalB,EAAQO,iBAAmB,WAEpDY,EAAW,GAAIT,sBAAqB,SAASC,GAC7CA,EAAQC,QAAQ,SAASC,GACrB,GAAIO,GAAWP,EAAMQ,mBAAmBC,EACpCC,EAAeV,EAAMC,iBACrBD,GAAMW,gBAAkBD,GAAgBnB,GAAagB,EAAWjB,GAChEU,EAAME,OAAOC,cAAc,GAAIC,OAAM,cAEzCd,EAAQiB,EACRhB,EAAYmB,MAGhBL,WAAYlB,EAAQQ,mBAAqB,mBAE7CC,GAAOgB,QAAQ1B,GACfoB,EAASM,QAAQ1B,GAGrB,GAAI2B,IACA5B,KAAMA,EACN6B,QAAS,aAMS,oBAAXC,SAAoD,mBAAnBA,QAAOC,QAC/CD,OAAOC,QAAUH,EAEjBI,OAAOJ,YAAcA","file":"ad-refresher.min.js","sourcesContent":["(function() {\n    function init(element, options) {\n        var LOADING_AD_POSITION_THRESHOLD = 300;\n        var RELOADING_AD_POSITION_THRESHOLD = 150;\n        var lastY = 0;\n        var lastRatio = 0;\n\n        if (!element) {\n            throw new Error('Element is not defined');\n        }\n\n        if (element[0] instanceof Element) {\n            element = element[0];\n        }\n\n        options = options || {};\n        options.loadingThreshold = options.loadingThreshold || LOADING_AD_POSITION_THRESHOLD;\n        options.reloadingThreshold = options.reloadingThreshold || RELOADING_AD_POSITION_THRESHOLD;\n\n        var loader = new IntersectionObserver(function(entries) {\n            entries.forEach(function(entry) {\n                if (entry.intersectionRatio > 0) {\n                    entry.target.dispatchEvent(new Event('load-ad'));\n                }\n            });\n        }, {\n            rootMargin: '0px 0px ' + options.loadingThreshold + 'px 0px'\n        });\n        var reloader = new IntersectionObserver(function(entries) {\n            entries.forEach(function(entry) {\n                var currentY = entry.boundingClientRect.y;\n                var currentRatio = entry.intersectionRatio;\n                if (entry.isIntersecting && currentRatio >= lastRatio && currentY > lastY) {\n                    entry.target.dispatchEvent(new Event('reload-ad'));\n                }\n                lastY = currentY;\n                lastRatio = currentRatio;\n            });\n        }, {\n            rootMargin: options.reloadingThreshold + 'px 0px 00px 0px'\n        });\n        loader.observe(element);\n        reloader.observe(element);\n    }\n\n    var AdRefresher = {\n        init: init,\n        refresh: function() {\n            //kept for backwards compatibility\n        }\n    };\n\n// make available to common module loader\n    if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n        module.exports = AdRefresher;\n    } else {\n        window.AdRefresher = AdRefresher;\n    }\n})();"]}